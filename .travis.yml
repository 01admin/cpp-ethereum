#------------------------------------------------------------------------------
# TravisCI configuration file for cpp-ethereum.
#
# The documentation for cpp-ethereum is hosted at:
#
# http://www.ethdocs.org/en/latest/ethereum-clients/cpp-ethereum/
#
# (c) 2016 cpp-ethereum contributors.
#------------------------------------------------------------------------------

language: cpp
matrix:
    include:
        - os: linux
          dist: trusty
          sudo: required
          env: TRAVIS_BUILD_TYPE=Debug
        - os: osx
          osx_image: xcode7.1
          env: TRAVIS_BUILD_TYPE=Debug
        - os: osx
          osx_image: xcode7.3
          env: TRAVIS_BUILD_TYPE=Debug
git:
    depth: 2
branches:
    except:
        - /cpp-ethereum-appveyor-v[0-9]/
before_install:
    - ./install_deps.sh
before_script:
    - cd ..
    - git clone https://github.com/ethereum/tests.git
    - export ETHEREUM_TEST_PATH=$(pwd)/tests/
    - cd cpp-ethereum
    - mkdir build
    - cd build
    - cmake .. -DCMAKE_BUILD_TYPE=$TRAVIS_BUILD_TYPE
script:
    - cmake --build .
#    - 7z a cpp-ethereum.zip eth/Debug/eth eth/Debug/*.so
    - ./test/libethereum/test/testeth
    - ./test/libweb3core/test/testweb3core
    - ./test/webthree/test/testweb3
#deploy:
#    provider: releases
#    api_key: "GITHUB OAUTH TOKEN"
#    file: cpp-ethereum.zip
#    skip_cleanup: true
#    on:
#        tags: true
